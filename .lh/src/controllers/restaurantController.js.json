{
    "sourceFile": "src/controllers/restaurantController.js",
    "activeCommit": 0,
    "commits": [
        {
            "activePatchIndex": 0,
            "patches": [
                {
                    "date": 1761547016967,
                    "content": "Index: \n===================================================================\n--- \n+++ \n"
                }
            ],
            "date": 1761547016967,
            "name": "Commit-0",
            "content": "import Restaurant from \"../models/restaurantModel.js\";\r\n\r\n// ğŸŸ¢ Láº¥y danh sÃ¡ch (chá»‰ láº¥y quÃ¡n chÆ°a xÃ³a)\r\nexport const getRestaurants = async (req, res) => {\r\n  try {\r\n    const data = await Restaurant.find({ isDeleted: false }).sort({\r\n      createdAt: -1,\r\n    });\r\n    res.json(data);\r\n  } catch (error) {\r\n    res.status(500).json({ message: error.message });\r\n  }\r\n};\r\n\r\n// ğŸŸ¢ Láº¥y chi tiáº¿t 1 quÃ¡n\r\nexport const getRestaurantById = async (req, res) => {\r\n  try {\r\n    const item = await Restaurant.findOne({\r\n      _id: req.params.id,\r\n      isDeleted: false,\r\n    });\r\n    if (!item)\r\n      return res.status(404).json({ message: \"KhÃ´ng tÃ¬m tháº¥y quÃ¡n Äƒn\" });\r\n    res.json(item);\r\n  } catch (error) {\r\n    res.status(500).json({ message: error.message });\r\n  }\r\n};\r\n\r\n// ğŸŸ¢ Táº¡o má»›i quÃ¡n Äƒn\r\nexport const createRestaurant = async (req, res) => {\r\n  try {\r\n    const body = req.body;\r\n\r\n    // Náº¿u cÃ³ file upload (multer + Cloudinary)\r\n    if (req.file) {\r\n      // CloudinaryStorage tá»± gÃ¡n URL vÃ o req.file.path\r\n      body.menuImage = req.file.path;\r\n    }\r\n\r\n    const newItem = new Restaurant(body);\r\n    const saved = await newItem.save();\r\n\r\n    res.status(201).json(saved);\r\n  } catch (error) {\r\n    res.status(400).json({ message: error.message });\r\n  }\r\n};\r\n\r\n// ğŸŸ¢ Cáº­p nháº­t quÃ¡n Äƒn\r\nexport const updateRestaurant = async (req, res) => {\r\n  try {\r\n    const updateData = req.body;\r\n    if (req.file) {\r\n      updateData.menuImage = `/uploads/${req.file.filename}`;\r\n    }\r\n\r\n    const updated = await Restaurant.findOneAndUpdate(\r\n      { _id: req.params.id, isDeleted: false },\r\n      updateData,\r\n      { new: true }\r\n    );\r\n    if (!updated)\r\n      return res.status(404).json({ message: \"KhÃ´ng tÃ¬m tháº¥y quÃ¡n Äƒn\" });\r\n    res.json(updated);\r\n  } catch (error) {\r\n    res.status(400).json({ message: error.message });\r\n  }\r\n};\r\n\r\n// ğŸŸ¢ \"XÃ³a má»m\" quÃ¡n Äƒn\r\nexport const softDeleteRestaurant = async (req, res) => {\r\n  try {\r\n    const deleted = await Restaurant.findByIdAndUpdate(\r\n      req.params.id,\r\n      { isDeleted: true },\r\n      { new: true }\r\n    );\r\n    if (!deleted)\r\n      return res.status(404).json({ message: \"KhÃ´ng tÃ¬m tháº¥y quÃ¡n Äƒn\" });\r\n    res.json({ message: \"ÄÃ£ chuyá»ƒn quÃ¡n sang tráº¡ng thÃ¡i isDeleted=true\" });\r\n  } catch (error) {\r\n    res.status(500).json({ message: error.message });\r\n  }\r\n};\r\n\r\n// ğŸŸ¢ Restore quÃ¡n Ä‘Ã£ xÃ³a\r\nexport const restoreRestaurant = async (req, res) => {\r\n  try {\r\n    const restored = await Restaurant.findByIdAndUpdate(\r\n      req.params.id,\r\n      { isDeleted: false },\r\n      { new: true }\r\n    );\r\n    if (!restored)\r\n      return res.status(404).json({ message: \"KhÃ´ng tÃ¬m tháº¥y quÃ¡n Äƒn\" });\r\n    res.json({ message: \"ÄÃ£ khÃ´i phá»¥c quÃ¡n Äƒn\" });\r\n  } catch (error) {\r\n    res.status(500).json({ message: error.message });\r\n  }\r\n};\r\n"
        }
    ]
}